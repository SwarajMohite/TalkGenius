<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>SpeakSmart - AI Speech Coach</title>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; background: #f5f5f5; }
    .container { max-width: 600px; margin: auto; padding: 20px; }
    button { padding: 10px 20px; margin: 10px; font-size: 16px; cursor: pointer; }
    .result { background: white; padding: 20px; margin-top: 20px; border-radius: 10px; }
  </style>
</head>
<body>
  <div class="container">
    <h1>üéôÔ∏è SpeakSmart - AI Speech Coach</h1>
    <p>Click to record your speech and get AI feedback</p>
    <button id="recordBtn">üé§ Start Recording</button>
    <button id="stopBtn" disabled>‚èπÔ∏è Stop</button>

    <div class="result" id="output"></div>
  </div>

  <script>
    let mediaRecorder, audioChunks = [];

    document.getElementById("recordBtn").addEventListener("click", async () => {
      let stream = await navigator.mediaDevices.getUserMedia({ audio: true });
      mediaRecorder = new MediaRecorder(stream);
      mediaRecorder.start();
      audioChunks = [];

      mediaRecorder.ondataavailable = e => audioChunks.push(e.data);
      mediaRecorder.onstop = async () => {
        let blob = new Blob(audioChunks, { type: 'audio/wav' });
        let formData = new FormData();
        formData.append("audio", blob, "speech.wav");

        let response = await fetch("/analyze", {
          method: "POST",
          body: formData
        });

        let data = await response.json();
        document.getElementById("output").innerHTML = `
          <h3>üìù Transcript:</h3><p>${data.transcript}</p>
          <p><b>WPM:</b> ${data.wpm}</p>
          <p><b>Filler Words:</b> ${data.filler_count}</p>
          <p><b>Pauses:</b> ${data.pauses}</p>
          <h3>üí° Suggestions:</h3>
          <ul>${data.suggestions.map(s => `<li>${s}</li>`).join("")}</ul>
        `;
      };

      document.getElementById("recordBtn").disabled = true;
      document.getElementById("stopBtn").disabled = false;
    });

    document.getElementById("stopBtn").addEventListener("click", () => {
      mediaRecorder.stop();
      document.getElementById("recordBtn").disabled = false;
      document.getElementById("stopBtn").disabled = true;
    });
  </script>
</body>
</html>
